<!DOCTYPE html>
<html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<style> /* set the CSS */
    body {font-family: "Times New Roman", Georgia, Serif;}
    h1,h2,h3,h4,h5,h6 {
        font-family: "Playfair Display";
        letter-spacing: 5px;
    }
    button {
    border: none;
    background-color: transparent;
    outline: none;
    padding: 0px;
    margin: 0px 0px;
    border: 0px;
    height: 100%
    }
    button:hover {
    border: 1px solid;
    }
</style>
<head>
  <title>PHP Test</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
      <!-- load the d3.js library -->    
    <script src="http://d3js.org/d3.v3.min.js"></script>
</head>
<body>
    <!-- Navbar (sit on top) -->
<nav class="w3-top">
  <div class="w3-bar w3-white w3-padding w3-card-2" style="letter-spacing:4px;">
    <a href="#home" class="w3-bar-item">Assignment 1</a>
    <!-- Right-sided navbar links. Hide them on small screens -->
    <div class="w3-right w3-hide-small">
      <a class="w3-bar-item">sanec@fotonik.dtu.dk</a>
    </div>
  </div>

</nav>
<!-- Header -->
<header class="w3-container w3-center" style="max-width:1600px;min-width:500px" id="home">
    <!-- <div class="w3-display-bottomleft w3-padding-large" style="color:black"> -->
    <div class="w3-content" style="margin-top:60px" >
        <h1 class="w3-xxlarge"> Visualization of numerical data</h1>
    </div>
    <!-- </div> -->
</header>
<!-- Page content -->
<div class="w3-content" style="max-width:1100px">
    
    <p>
      <h2> About the data </h2> 

    </p>
    

    <!-- load data--> 
    <script src="/data/declaration.js"></script>

    <div class="w3-row w3-padding" id="figure_container" style="width:1000px;height:600px">
        <div id="tester" style="width:800px;height:600px; position:relative">
            <div class="hideshow" id="glob" style="position:absolute; bottom:100px; right:-60px">
                <button id='blue_btn'>
                    <!-- <img src="https://upload.wikimedia.org/wikipedia/commons/8/80/World_map_-_low_resolution.svg", id='world_map'> -->
                <a title="Al MacDonald [2]/ twitter account @F1LT3R [CC BY-SA 3.0 (http://creativecommons.org/licenses/by-sa/3.0)], via Wikimedia Commons" ><img width="220" alt="World map - low resolution" src="https://upload.wikimedia.org/wikipedia/commons/8/80/World_map_-_low_resolution.svg" id ="world_fig"/>
                </a>
                </button>
            </div>
            <div class="hideshow" id="n_hem" style="position:absolute; bottom:165px; right:-60px">
                <button id='orange_btn'>
                <script>
                    var svg = d3.select('#orange_btn')
                                .append('svg')
                                .attr('width',document.getElementById('world_fig').width/2)
                                .attr('height', document.getElementById('world_fig').height/2 )
                    svg.append('rect')
                        .attr('width',document.getElementById('world_fig').width/2)
                        .attr('height', document.getElementById('world_fig').height/2 )
                        .attr('x',0)
                        .attr('y',0)    
                        .style("opacity", .2)   
                        .style("stroke", "blue")                        
                        .style('fill','blue')
                </script>
                </button>
            </div>
            <div class="hideshow" id="s_hem" style="position:absolute; bottom:93px; right:-60px">
                <button id='green_btn'>
                <script>
                    var svg = d3.select('#green_btn')
                                .append('svg')
                                .attr('width',document.getElementById('world_fig').width/2)
                                .attr('height', document.getElementById('world_fig').height/2 )
                    svg.append('rect')
                        .attr('width',document.getElementById('world_fig').width/2)
                        .attr('height', document.getElementById('world_fig').height/2 )
                        .attr('x',0)
                        .attr('y',0)
                        .style("opacity", .2)   
                        .style("stroke", "green")       
                        .style('fill','green')
                </script>
                </button>
            </div>
        </div>
    </div>
    
    <div class="w3-row w3-padding" id="instructions">
        <p>
          <h2> Basic use instructions </h2>  
        
        <ul>
            <li>Click and drag in the canvas to zoom in</li>
            <li>Double click the canvas to zoom out</li>
            <li>Click the elements in the legend to toggle display</li>
            <li>Double click the elements in the legend to display only one</li>
        </ul>
        </p>
    </div>
<!-- End page content -->
</div>
<!-- Footer -->
<footer class="w3-center w3-light-grey w3-padding-32">
  <p>Powered by <a href="https://www.w3schools.com/w3css/default.asp" title="W3.CSS" target="_blank" class="w3-hover-text-green">w3.css</a></p>
</footer>

<script>
    function unpack(rows, key) {
     return rows.map(function(row) { return row[key]; });
    }        // Plotly.newPlot('tester',data);


    var scopes = ["Glob","NHem","SHem"];
    var names  = ["Global","North Hemisphere","South Hemisphere"];
    var dashes = ['solid','dashdot','dash'];
    var colors = ['red','blue','green'];
    var widths = [3,1,1];
    var x = unpack(data, 'Year');

    var new_data = scopes.map(function(scope, i){
        var y = unpack(data, scope);
        for (var y_idx = y.length - 1; y_idx >= 0; y_idx--) {
            y[y_idx] = y[y_idx]/10;
        };
        var mode = 'markers';
        var text = scope;
        var trace = {
            x:x,
            y:y,
            type: 'scatter',
            text: scopes[i],
            name: names[i],
            line: {
                dash: dashes[i],
                width: widths[i],
                color: colors[i]
            },
            hoverinfo:"x+y+text"
        };
        return trace
    });

    
    var layout = {
        xaxis:
        {
            title: "Year",
            showgrid: false,
            domain:[d3.min(x),d3.min(x)],
            showline:true,
            linewidth:2,
            zerolinecolor:"#6e7075",
            spikethickness:1
        },
        yaxis:
        {
            title: "Temperature anomaly (&deg;C)",
            position: 0,
            color: "black",
            showline: true,
            showgrid: true,
            linewidth:2,
            spikethickness:1
        },
        hovermode: 'closest',
        title: 'Land-Ocean Temperature Index',
        showlegend: true,
        font: {size:15},
        zerolinecolor:"#6e7075"

    };
    
    Plotly.newPlot('tester', new_data, layout, {scrollZoom: false});
    
    $('.hideshow button').click(function(){
        var btn_id = this.parentNode.id;
            //data_index = 0,
        if (btn_id === 'glob'){
            var data_index = 0;
        } 
        else if (btn_id === 'n_hem'){
            var data_index = 1;  
        }
        else if (btn_id === 's_hem'){
            var data_index = 2;  
        }
        
        var tester = document.getElementById("tester");
        var visible = tester.data[data_index].visible;

        if( visible === undefined ) {
            Plotly.restyle("tester", 'visible', "legendonly")
            visible = true;
        }
        else if ( visible === true ){
            //Plotly.restyle("tester", 'visible', true)
            visible = "legendonly";
        }
        else if ( visible === "legendonly" ){
            Plotly.restyle("tester", 'visible', "legendonly")
            visible = true 
        }

        Plotly.restyle("tester", 'visible', visible, data_index);
    });
</script>

</body>
</html>